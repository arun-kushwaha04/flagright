generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "debian-openssl-3.0.x", "linux-arm64-openssl-1.1.x", "rhel-openssl-3.0.x"]
}

datasource db {
  provider = "postgres"
  url      = env("DB_CONNECTION_URL")
}

// generator erd {
//   provider = "prisma-erd-generator"
// }

enum UserType {
  ADMIN
  NORMAL
}

enum TransactionType {
  DEPOSIT
  WITHDRAWL
  TRANSFER
  SELFTRANSFER
}

model User {
  id            Int      @id @default(autoincrement())
  email         String   @unique
  firstName     String
  lastName      String
  password      String
  userType      UserType @default(NORMAL)
  defaultBankId Int

  banks                   UserBank[]
  transactionsOrigin      Transaction[] @relation("origin")
  transactionsDestination Transaction[] @relation("destination")
  defaultBank             Bank          @relation("default bank", fields: [defaultBankId], references: [id])
}

model Bank {
  id       Int      @id @default(autoincrement())
  name     String
  currency Currency

  users                   UserBank[]
  defaultUsers            User[]        @relation("default bank")
  transactionsOrigin      Transaction[] @relation("origin bank")
  transactionsDestination Transaction[] @relation("destination bank")
}

model UserBank {
  userId  Int
  bankId  Int
  balance Int @default(0) 

  user User @relation(fields: [userId], references: [id])
  bank Bank @relation(fields: [bankId], references: [id])

  @@id([userId, bankId])
}

model Transaction {
  id                        Int      @id @default(autoincrement())
  originId                  Int
  origin                    User     @relation("origin", fields: [originId], references: [id])
  destinationId             Int
  destination               User     @relation("destination", fields: [destinationId], references: [id])
  originAmount              Float
  originAmountCurrency      Currency
  originBankId              Int
  destinationAmount         Float
  destinationAmountCurrency Currency
  destinationBankId         Int
  description               String
  type TransactionType
  createdAt                 DateTime @default(now())
  updatedAt                 DateTime @updatedAt

  originBank      Bank @relation("origin bank", fields: [originBankId], references: [id])
  destinationBank Bank @relation("destination bank", fields: [destinationBankId], references: [id])

  @@index([originId])
  @@index([destinationId])
  @@index([createdAt])
}

enum Currency {
  INCH // 1inch Network
  AAVE // Aave
  ABT // ArcBlock
  ACH // Alchemy Pay
  ACS // Access Protocol
  ADA // Cardano
  AED // United Arab Emirates Dirham
  AERGO // Aergo
  AERO // AERON
  AFN // Afghan Afghani
  AGLD // Agld
  AIOZ // Aioz Network
  ALCX // Alchemix
  ALEPH // Aleph.im
  ALGO // Algorand
  ALICE // My Neighbor Alice
  ALL // All
  AMD // Armenian Dram
  AMP // Amp
  ANG // Netherlands Antillean Guilder
  ANKR // Ankr
  ANT // Aragon
  AOA // Angolan Kwanza
  APE // ApeCoin
  API3 // API3
  APT // Aptos
  ARB // Arbitrum
  ARPA // ARPA Chain
  ARS // Argentine Peso
  ASM // Asm
  AST // Asch
  ATA // Atatica
  ATOM // Cosmos
  AUCTION // Auction
  AUD // Australian Dollar
  AUDIO // Audius
  AURORA // Aurora
  AVAX // Avalanche
  AVT // Aventus
  AWG // Aruban Florin
  AXL // Axelar
  AXS // Axie Infinity
  AZN // Azerbaijani Manat
  BADGER // Badger DAO
  BAL // Balancer
  BAM // Bosnia and Herzegovina Convertible Mark
  BAND // Band Protocol
  BAT // Basic Attention Token
  BBD // Barbados Dollar
  BCH // Bitcoin Cash
  BDT // Bangladeshi Taka
  BGN // Bulgarian Lev
  BHD // Bahraini Dinar
  BICO // Biconomy
  BIF // Burundian Franc
  BIGTIME // Big Time
  BIT // BitDAO
  BLUR // Blur
  BLZ // Bluzelle
  BMD // Bermudian Dollar
  BND // Brunei Dollar
  BNT // 0x
  BOB // Bolivian Boliviano
  BOBA // Boba Network
  BOND // Bondly
  BONK // Bonk
  BRL // Brazilian Real
  BSD // Bahamian Dollar
  BSV // Bitcoin SV
  BTC // Bitcoin
  BTN // Bhutanese Ngultrum
  BTRST // Braintrust
  BUSD // Binance USD
  BWP // Botswana Pula
  BYN // Belarusian Ruble
  BYR // Belarusian Ruble (old)
  BZD // Belize Dollar
  C98 // Coin98
  CAD // Canadian Dollar
  CBETH // Coinbase Wrapped Staked ETH
  CDF // Congolese Franc
  CELR // Celer Network
  CGLD // Celo Dollar
  CHF // Swiss Franc
  CHZ // Chiliz
  CLF // Chilean Unit of Account (UF)
  CLP // Chilean Peso
  CLV // Clover Finance
  CNH // Chinese Yuan (offshore)
  CNY // Chinese Yuan
  COMP // Compound
  COP // Colombian Peso
  COTI // Coti
  COVAL // Covalent
  CRC // Costa Rican Colón
  CRO // Crypto.com Coin
  CRPT // Crypterium
  CRV // Curve DAO Token
  CTSI // Cartesi
  CTX // Cortex
  CUC // Cuban Convertible Peso
  CUP // Cuban Peso
  CVC // Civic
  CVE // Cape Verdean Escudo
  CVX // Convex Finance
  CZK // Czech Koruna
  DAI // DAI
  DAR // Darma
  DASH // Dash
  DDX // DDEX
  DESO // DeSo
  DEXT // DEXTools
  DIA // DIA
  DIMO // Dimo
  DJF // Djiboutian Franc
  DKK // Danish Krone
  DNT // district0x
  DOGE // Dogecoin
  DOP // Dominican Peso
  DOT // Polkadot
  DREP // Drep
  DYP // DeFi Yield Protocol
  DZD // Algerian Dinar
  EEK // Estonian Kroon
  EGLD // Elrond
  EGP // Egyptian Pound
  ELA // Elastos
  ENJ // Enjin Coin
  ENS // Ethereum Name Service
  EOS // EOS
  ERN // Eritrean Nakfa
  ETB // Ethiopian Birr
  ETC // Ethereum Classic
  ETH // Ethereum
  ETH2 // Ethereum 2.0
  EUR // Euro
  EUROC // Euro Coin
  FARM // Harvest Finance
  FET // Fetch.ai
  FIDA // Bonfida
  FIL // Filecoin
  FIS // Stafi
  FJD // Fijian Dollar
  FKP // Falkland Islands Pound
  FLOW // Flow
  FLR // Flare
  FORT // Fort
  FORTH // Ampleforth
  FOX // ShapeShift
  FX // Flexa
  GAL // Galxe
  GALA // Gala Games
  GBP // British Pound Sterling
  GEL // Georgian Lari
  GFI // Goldfinch
  GGP // Guernsey Pound
  GHS // Ghanaian Cedi
  GHST // Aavegotchi
  GIP // Gibraltar Pound
  GLM // Golem
  GMD // Gambian Dalasi
  GMT // STEPN
  GNF // Guinean Franc
  GNO // Gnosis
  GNT // Golem
  GODS // Gods Unchained
  GRT // The Graph
  GST // Green Satoshi Token
  GTC // Gitcoin
  GTQ // Guatemalan Quetzal
  GUSD // Gemini Dollar
  GYD // Guyanese Dollar
  GYEN // Great British Pound (Yen)
  HBAR // Hedera Hashgraph
  HFT // Hegic
  HIGH // Highstreet
  HKD // Hong Kong Dollar
  HNL // Honduran Lempira
  HNT // Helium
  HONEY // HONEY
  HOPR // Hopr
  HRK // Croatian Kuna
  HTG // Haitian Gourde
  HUF // Hungarian Forint
  ICP // Internet Computer
  IDEX // IDEX
  IDR // Indonesian Rupiah
  ILS // Israeli New Shekel
  ILV // Illuvium
  IMP // Isle of Man Pound
  IMX // Immutable X
  INDEX // Index
  INJ // Injective Protocol
  INR // Indian Rupee
  INV // Invictus
  IOTX // IoTeX
  IQD // Iraqi Dinar
  IRR // Iranian Rial
  ISK // Icelandic Króna
  JASMY // Jasmy
  JEP // Jersey Pound
  JMD // Jamaican Dollar
  JOD // Jordanian Dinar
  JPY // Japanese Yen
  JTO // Jeto
  JUP // Jupiter
  KAVA // Kava
  KEEP // Keep Network
  KES // Kenyan Shilling
  KGS // Kyrgyzstani Som
  KHR // Cambodian Riel
  KMF // Comorian Franc
  KNC // Kyber Network
  KPW // North Korean Won
  KRL // Kleros
  KRW // South Korean Won
  KSM // Kusama
  KWD // Kuwaiti Dinar
  KYD // Cayman Islands Dollar
  KZT // Kazakhstani Tenge
  LAK // Laotian Kip
  LBP // Lebanese Pound
  LCX // LCX
  LDO // Lido DAO
  LINK // Chainlink
  LIT // Litentry
  LKR // Sri Lankan Rupee
  LOKA // Loka
  LOOM // Loom Network
  LPT // Livepeer
  LQTY // Liquity
  LRC // Loopring
  LRD // Liberian Dollar
  LSETH // Lido Staked Ether
  LSL // Lesotho Loti
  LTC // Litecoin
  LTL // Lithuanian Litas
  LVL // Latvian Lats
  LYD // Libyan Dinar
  MAD // Moroccan Dirham
  MAGIC // Magic
  MANA // Decentraland
  MASK // Mask Network
  MATH // MATH
  MATIC // Polygon
  MCO2 // Moss Carbon Credit
  MDL // Moldovan Leu
  MDT // Media
  MEDIA // Media
  METIS // Metis
  MGA // Malagasy Ariary
  MINA // Mina Protocol
  MIR // Mirror Protocol
  MKD // Macedonian Denar
  MKR // Maker
  MLN // Enzyme
  MMK // Myanmar Kyat
  MNDE // MinD
  MNT // Mongolian Tögrög
  MOBILE // Mobile
  MONA // MonaCoin
  MOP // Macanese Pataca
  MPL // Maple
  MRO // Mauritanian Ouguiya
  MRU // Mauritian Rupee
  MSOL // Marin
  MTL // Metal
  MULTI // MultiChain
  MUR // Mauritian Rupee
  MUSE // Muse
  MVR // Maldivian Rufiyaa
  MWK // Malawian Kwacha
  MXC // MXC
  MXN // Mexican Peso
  MYR // Malaysian Ringgit
  MZN // Mozambican Metical
  NAD // Namibian Dollar
  NCT // Nucleus Vision
  NEAR // NEAR Protocol
  NEST // Nestle
  NGN // Nigerian Naira
  NIO // Nicaraguan Córdoba
  NKN // NKN
  NMR // Numeraire
  NOK // Norwegian Krone
  NPR // Nepalese Rupee
  NU // NuCypher
  NZD // New Zealand Dollar
  OCEAN // Ocean Protocol
  OGN // Origin Protocol
  OMG // OMG Network
  OMR // Omani Rial
  ONDO // Ondo
  OOKI // Ooki
  OP // Optimism
  ORCA // Orca
  ORN // Orion Protocol
  OSMO // Osmosis
  OXT // Orchid
  PAB // Panamanian Balboa
  PAX // Paxos Standard
  PEN // Peruvian Sol
  PERP // Perpetual Protocol
  PGK // Papua New Guinean Kina
  PHP // Philippine Peso
  PKR // Pakistani Rupee
  PLA // PlayDapp
  PLN // Polish Zloty
  PLU // Pluton
  PNG // Papua New Guinea Kina
  POLS // Polkastarter
  POLY // Polymath
  POND // Marlin
  POWR // Power Ledger
  PRIME // Prime
  PRO // Pro
  PRQ // PARSIQ
  PUNDIX // Pundi X
  PYG // Paraguayan Guarani
  PYR // Vulcan Forged
  PYUSD // PayPal USD
  QAR // Qatari Rial
  QI // Qi
  QNT // Quant
  QSP // Quantstamp
  QUICK // QuickSwap
  RAD // Radicle
  RAI // RAI
  RARE // Rare
  RARI // Rarible
  RBN // Ribbon Finance
  REN // Ren
  RENDER // Render Token
  REP // Augur
  REPV2 // Augur (v2)
  REQ // Request
  RGT // Rari Governance Token
  RLC // iExec RLC
  RLY // Rally
  RNDR // Render Token
  RON // Romanian Leu
  ROSE // Oasis Network
  RPL // Rocket Pool
  RSD // Serbian Dinar
  RUB // Russian Ruble
  RWF // Rwandan Franc
  SAND // The Sandbox
  SAR // Saudi Riyal
  SBD // Steem Dollar
  SCR // Seychellois Rupee
  SDG // Sudanese Pound
  SEAM // Seam
  SEI // Sei
  SEK // Swedish Krona
  SGD // Singapore Dollar
  SHIB // Shiba Inu
  SHP // Saint Helena Pound
  SHPING // Shping
  SKK // Slovak Koruna
  SKL // SKALE
  SLL // Sierra Leonean Leone
  SNT // Status
  SNX // Synthetix
  SOL // Solana
  SOS // Somali Shilling
  SPA // Spa
  SPELL // Spell Token
  SRD // Surinamese Dollar
  SSP // South Sudanese Pound
  STD // São Tomé and Príncipe Dobra
  STG // Stargate Finance
  STORJ // Storj
  STRK // Staked Strudel
  STX // Stacks
  SUI // Sui
  SUKU // Suku
  SUPER // SuperFarm
  SUSHI // SushiSwap
  SVC // Salvadoran Colón
  SWFTC // SwftCoin
  SYLO // Sylo
  SYN // Synapse
  SYP // Syrian Pound
  SZL // Swazi Lilangeni
  T // Tether
  THB // Thai Baht
  TIA // Tia
  TIME // Wonderland
  TJS // Tajikistani Somoni
  TMM // TMM
  TMT // Turkmenistani Manat
  TND // Tunisian Dinar
  TONE // Toncoin
  TOP // Tongan Paʻanga
  TRAC // OriginTrail
  TRB // Tellor
  TRIBE // Tribe
  TRU // TrueFi
  TRY // Turkish Lira
  TTD // Trinidad and Tobago Dollar
  TVK // Terra Virtua Kolect
  TWD // New Taiwan Dollar
  TZS // Tanzanian Shilling
  UAH // Ukrainian Hryvnia
  UGX // Ugandan Shilling
  UMA // UMA
  UNFI // Unifi Protocol DAO
  UNI // Uniswap
  UPI // UPI
  USD // United States Dollar
  USDC // USD Coin
  USDT // Tether
  UST // TerraUSD
  UYU // Uruguayan Peso
  UZS // Uzbekistani Som
  VARA // Vara
  VEF // Venezuelan Bolívar
  VELO // Velodrome
  VES // Venezuelan Bolívar Soberano
  VET // VeChain
  VGX // Voyager Token
  VND // Vietnamese Dong
  VOXEL // Voxies
  VTHO // VeChainThor
  VUV // Vanuatu Vatu
  WAMPL // WAMPL
  WAXL // WAX
  WBTC // Wrapped Bitcoin
  WCFG // Wrapped Centrifuge
  WLUNA // Wrapped LUNA
  WST // Samoan Tala
  XAF // Central African CFA Franc
  XAG // Silver Ounce
  XAU // Gold Ounce
  XCD // East Caribbean Dollar
  XCN // CryptoNote
  XDR // Special Drawing Rights
  XLM // Stellar
  XMON // XMON
  XOF // West African CFA Franc
  XPD // Palladium Ounce
  XPF // CFP Franc
  XPT // Platinum Ounce
  XRP // XRP
  XTZ // Tezos
  XYO // XYO Network
  YER // Yemeni Rial
  YFI // Yearn.Finance
  YFII // Yearn Finance II
  ZAR // South African Rand
  ZEC // Zcash
  ZEN // Horizen
  ZETA // Zeta
  ZMK // Zambian Kwacha (old)
  ZMW // Zambian Kwacha
  ZRX // 0x
  ZWD // Zimbabwean Dollar
}
